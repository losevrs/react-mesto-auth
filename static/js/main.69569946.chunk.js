(this["webpackJsonpmesto-react-func"]=this["webpackJsonpmesto-react-func"]||[]).push([[0],{21:function(e,t,a){e.exports=a.p+"static/media/logo.c6f11019.svg"},22:function(e,t,a){e.exports=a.p+"static/media/onerror.a6166131.jpg"},26:function(e,t,a){e.exports=a(37)},31:function(e,t,a){},37:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(19),r=a.n(c),i=a(7),u=(a(31),a(1)),l=a(2),s=a(25),m=function(e){var t=e.component,a=Object(s.a)(e,["component"]);return o.a.createElement(l.b,null,(function(){return!0===a.loggedIn?o.a.createElement(t,a):o.a.createElement(l.a,{to:"/sign-in"})}))},p=a(16),d=a(21),_=a.n(d),f=function(e){return o.a.createElement("header",{className:"header"},o.a.createElement("img",{className:"header__logo",src:_.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f"}),o.a.createElement("div",{className:"header__children"},e.children))},b=a(22),h=a.n(b),v=function(e){var t=o.a.useState(!1),a=Object(u.a)(t,2),n=a[0],c=a[1];o.a.useEffect((function(){c(!1)}),[e.src]);return o.a.createElement("img",{className:e.className,src:n?h.a:e.src,alt:e.alt,onError:function(){c(!0)},onClick:e.onClick})},E=o.a.createContext(),g=function(){return Object(n.useContext)(E)},C=function(e){return o.a.createElement(E.Provider,{value:e.value},e.children)},O=function(e){var t=e.card,a=e.onCardClick,n=e.onCardLike,c=e.onCardDelete,r=g(),i=t.owner._id===r._id,u=t.likes.some((function(e){return e._id===r._id}));return o.a.createElement("div",{className:"photocard"},o.a.createElement(v,{className:"photocard__viewport",src:t.link,alt:"\u0424\u043e\u0442\u043e \u043c\u0435\u0441\u0442\u0430",onClick:function(){a(t)},onError:null}),o.a.createElement("button",{className:"photocard__delete ".concat(i&&"photocard__delete_show"),type:"button",onClick:function(){c(t)}}),o.a.createElement("div",{className:"photocard__description"},o.a.createElement("h2",{className:"photocard__placename"},t.name),o.a.createElement("div",{className:"photocard__likes"},o.a.createElement("button",{className:"photocard__like ".concat(u&&"photocard__like_on"),type:"button",onClick:function(){n(t)}}),o.a.createElement("span",{className:"photocard__count"},t.likes.length))))},j=function(e){var t=e.onAddPlace.bind(void 0),a=e.onEditProfile.bind(void 0),n=e.onEditAvatar.bind(void 0),c=g();return o.a.createElement("main",{className:"main"},o.a.createElement("section",{className:"profile ".concat(e.isHidden&&"profile_hidden")},o.a.createElement("div",{className:"profile__avatar-overlay",onClick:n},o.a.createElement(v,{className:"profile__avatar",src:c.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"})),o.a.createElement("div",{className:"profile__info"},o.a.createElement("div",{className:"profile__title"},o.a.createElement("h1",{className:"profile__name"},c.name),o.a.createElement("button",{className:"profile__editbutton",onClick:a,type:"button"})),o.a.createElement("p",{className:"profile__about"},c.about)),o.a.createElement("button",{className:"profile__addbutton",onClick:t,type:"button"})),o.a.createElement("section",{className:"placesphotos"},e.cards.map((function(t){return o.a.createElement(O,{key:t._id,card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete})}))))},S=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))},k=function(e){var t=o.a.useRef(null),a=o.a.useCallback((function(t){"Escape"===t.key&&e.onClose()}),[]);return o.a.useEffect((function(){e.isOpened?document.addEventListener("keydown",a):document.removeEventListener("keydown",a)}),[e.isOpened]),o.a.createElement("section",{className:"popup popup_".concat(e.name," ").concat(e.isOpened&&"popup_opened"),onMouseDown:function(a){a.target===t.current&&e.onClose()},ref:t},e.children)},N=function(e){var t=!0;return void 0!==e.buttonEnabled&&(t=e.buttonEnabled),o.a.createElement(k,{name:e.name,isOpened:e.isOpened,onClose:e.onClose},o.a.createElement("form",{className:"popup__container",action:"#",method:"POST",name:"".concat(e.name),noValidate:!0,onSubmit:e.onSubmit},o.a.createElement("h2",{className:"popup__title"},"".concat(e.title)),e.children,o.a.createElement("button",{className:"popup__submit ".concat(t?"":"popup__submit_disabled"),disabled:t?"":"disabled",type:"submit"},e.buttonTitle),o.a.createElement("button",{className:"popup__reset",type:"button",onClick:e.onClose})))},T=function(e){var t=Object(n.useState)(!0),a=Object(u.a)(t,2),c=a[0],r=a[1],i=Object(n.useState)("None"),l=Object(u.a)(i,2),s=l[0],m=l[1],p=Object(n.useRef)(null);return Object(n.useEffect)((function(){p.current&&(r(p.current.validity.valid),m(p.current.validationMessage),void 0!==e.onButtonStatusChange&&e.onButtonStatusChange(p.current.validity.valid))})),o.a.createElement("div",{className:e.wrapClasses},o.a.createElement("input",{className:e.className,type:e.type,name:e.name,placeholder:e.placeholder,value:e.value,onChange:e.onChange,required:!!e.required,minLength:e.minLength,maxLength:e.maxLength,ref:p}),o.a.createElement("span",{className:"popup__input_type_error ".concat(!c&&e.isTouched?"popup__error_visible":"")},s))},y=function(e){var t=g(),a=o.a.useState(t.name),n=Object(u.a)(a,2),c=n[0],r=n[1],i=o.a.useState(!0),l=Object(u.a)(i,2),s=l[0],m=l[1],p=o.a.useState(!1),d=Object(u.a)(p,2),_=d[0],f=d[1],b=o.a.useState(t.about),h=Object(u.a)(b,2),v=h[0],E=h[1],C=o.a.useState(!0),O=Object(u.a)(C,2),j=O[0],S=O[1],k=o.a.useState(!1),y=Object(u.a)(k,2),w=y[0],L=y[1],x=s&&j;o.a.useEffect((function(){r(t.name),E(t.about)}),[t]);return o.a.createElement(N,{name:"profileedit",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonTitle:e.buttonTitle,buttonEnabled:x,isOpened:e.isOpened,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:c,about:v})}},o.a.createElement(T,{className:"popup__input popup__input_name popup__input_top",type:"text",name:"name",placeholder:"\u0418\u043c\u044f",value:c,onChange:function(e){f(!0),r(e.target.value)},required:!0,minLength:"2",maxLength:"40",isTouched:_,onButtonStatusChange:m}),o.a.createElement(T,{className:"popup__input popup__input_about",type:"text",name:"about",onChange:function(e){L(!0),E(e.target.value)},placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",value:v,required:!0,minLength:"2",maxLength:"200",isTouched:w,onButtonStatusChange:S}))},w=function(e){var t=Object(n.useState)(""),a=Object(u.a)(t,2),c=a[0],r=a[1],i=Object(n.useState)(!0),l=Object(u.a)(i,2),s=l[0],m=l[1],p=Object(n.useState)(!1),d=Object(u.a)(p,2),_=d[0],f=d[1],b=s,h=function(){r(""),f(!1)};return o.a.createElement(N,{name:"newavatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonTitle:e.buttonTitle,buttonEnabled:b,isOpened:e.isOpened,onClose:function(){e.onClose(),h()},onSubmit:function(t){t.preventDefault(),e.onUpdateAvatar({avatar:c}),h()}},o.a.createElement(T,{className:"popup__input popup__input_top",type:"url",name:"avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",value:c,onChange:function(e){f(!0),r(e.target.value)},required:!0,isTouched:_,onButtonStatusChange:m}))},L=function(e){var t=Object(n.useState)(""),a=Object(u.a)(t,2),c=a[0],r=a[1],i=Object(n.useState)(!0),l=Object(u.a)(i,2),s=l[0],m=l[1],p=Object(n.useState)(!1),d=Object(u.a)(p,2),_=d[0],f=d[1],b=Object(n.useState)(""),h=Object(u.a)(b,2),v=h[0],E=h[1],g=Object(n.useState)(!0),C=Object(u.a)(g,2),O=C[0],j=C[1],S=Object(n.useState)(!1),k=Object(u.a)(S,2),y=k[0],w=k[1],L=s&&O,x=function(){r(""),E(""),f(!1),w(!1)};return o.a.createElement(N,{name:"newplace",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonTitle:e.buttonTitle,buttonEnabled:L,isOpened:e.isOpened,onClose:function(){e.onClose(),x()},onSubmit:function(t){t.preventDefault(),e.onCreateCard({name:c,link:v}),e.onClose(),x()}},o.a.createElement(T,{className:"popup__input popup__input_photoname popup__input_top",type:"text",name:"photoName",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",value:c,onChange:function(e){f(!0),r(e.target.value)},required:!0,minLength:"1",maxLength:"30",isTouched:_,onButtonStatusChange:m}),o.a.createElement(T,{className:"popup__input popup__input_photourl",type:"url",name:"photoUrl",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",value:v,onChange:function(e){w(!0),E(e.target.value)},required:!0,isTouched:y,onButtonStatusChange:j}))},x=function(e){return o.a.createElement(N,{name:"confirm",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonTitle:e.buttonTitle,isOpened:e.isOpened,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onConfirm()}})},q=function(e){return o.a.createElement(k,{name:"view",isOpened:e.isOpened,onClose:e.onClose},o.a.createElement("div",{className:"popup__photoview"},o.a.createElement(v,{className:"popup__image",alt:"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0444\u043e\u0442\u043e",src:e.card.link}),o.a.createElement("h2",{className:"popup__imagetitle"},e.card.name),o.a.createElement("button",{className:"popup__reset",type:"button",onClick:e.onClose})))},P=a(23),B=a(24),U=new(function(){function e(t){Object(P.a)(this,e),this._options=t}return Object(B.a)(e,[{key:"_serverRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return fetch(this._options.baseUrl+e,{method:t,headers:{authorization:this._options.headers.authorization,"Content-Type":this._options.headers["Content-Type"]},body:JSON.stringify(a)}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"getUserInfo",value:function(){return this._serverRequest("users/me")}},{key:"saveProfile",value:function(e){return this._serverRequest("users/me","PATCH",e)}},{key:"saveAvatar",value:function(e){return this._serverRequest("users/me/avatar","PATCH",e)}},{key:"getInitialCards",value:function(){return this._serverRequest("cards")}},{key:"saveCard",value:function(e){return this._serverRequest("cards","POST",e)}},{key:"deleteCard",value:function(e){return this._serverRequest("cards/"+e,"DELETE")}},{key:"like",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=t?"PUT":"DELETE";return this._serverRequest("cards/likes/"+e,a)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-14/",headers:{authorization:"44e5d6af-1500-4757-9283-b4dfbe9e13fc","Content-Type":"application/json"}}),D=function(){var e=o.a.useState(!1),t=Object(u.a)(e,2),a=t[0],n=t[1],c=o.a.useState(!1),r=Object(u.a)(c,2),i=r[0],l=r[1],s=o.a.useState(!1),m=Object(u.a)(s,2),d=m[0],_=m[1],b=o.a.useState(!1),h=Object(u.a)(b,2),v=h[0],E=h[1],g=o.a.useState(!1),O=Object(u.a)(g,2),k=O[0],N=O[1],T=o.a.useState({}),P=Object(u.a)(T,2),B=P[0],D=P[1],R=o.a.useState({name:"",about:""}),A=Object(u.a)(R,2),I=A[0],H=A[1],M=o.a.useState([]),z=Object(u.a)(M,2),J=z[0],V=z[1],W=o.a.useState(!0),G=Object(u.a)(W,2),$=G[0],F=G[1],K=o.a.useState(!1),Q=Object(u.a)(K,2),X=Q[0],Y=Q[1];o.a.useEffect((function(){Promise.all([U.getUserInfo(),U.getInitialCards()]).then((function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];H(a),V(n)})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 : ",e)})).finally((function(){F(!1)}))}),[]);var Z=function(){n(!1),l(!1),_(!1),E(!1),N(!1),Y(!1),D({})};return o.a.createElement(C,{value:I},o.a.createElement(f,null),o.a.createElement(j,{onEditProfile:function(){n(!0)},onAddPlace:function(){l(!0)},onEditAvatar:function(){_(!0)},onCardClick:function(e){D(e),E(!0)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===I._id}));U.like(e._id,!t).then((function(t){var a=J.map((function(a){return a._id===e._id?t:a}));V(a)})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u043b\u0430\u0439\u043a\u0430 : ",e)}))},onCardDelete:function(e){D(e),N(!0)},isHidden:$,cards:J}),o.a.createElement(S,null),o.a.createElement(y,{isOpened:a,onClose:Z,onUpdateUser:function(e){var t=e.name,a=e.about;Y(!0),U.saveProfile({name:t,about:a}).then((function(e){H(e),Z()})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f : ",e)}))},buttonTitle:X?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),o.a.createElement(w,{isOpened:d,onClose:Z,onUpdateAvatar:function(e){var t=e.avatar;Y(!0),U.saveAvatar({avatar:t}).then((function(e){H(e),Z()})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0430\u0432\u0430\u0442\u0430\u0440\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f : ",e)}))},value:I.avatar,buttonTitle:X?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),o.a.createElement(L,{isOpened:i,onClose:Z,onCreateCard:function(e){Y(!0),U.saveCard(e).then((function(e){e&&V([e].concat(Object(p.a)(J)))})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 : ",e)}))},buttonTitle:X?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),o.a.createElement(x,{onConfirm:function(){Y(!0),U.deleteCard(B._id).then((function(){var e=Object(p.a)(J),t=e.findIndex((function(e){return e._id===B._id}));t>=0&&(e.splice(t,1),V(e)),Z()})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 : ",e)}))},onClose:Z,isOpened:k,buttonTitle:X?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0414\u0430"}),o.a.createElement(q,{card:B,isOpened:v,onClose:Z}))},R=function(e){var t=!0;return void 0!==e.buttonEnabled&&(t=e.buttonEnabled),o.a.createElement("form",{className:"signform",action:"#",method:"POST",name:"".concat(e.name),noValidate:!0,onSubmit:e.onSubmit},o.a.createElement("h2",{className:"signform__title"},"".concat(e.title)),e.children,o.a.createElement("button",{className:"signform__submit ".concat(t?"":"signform__submit_disabled"),disabled:t?"":"disabled",type:"submit"},e.buttonTitle),e.linkTo?o.a.createElement(i.b,{to:e.linkTo,className:"signform__link"},e.linkText):null)},A=function(e){var t=o.a.useState(""),a=Object(u.a)(t,2),n=a[0],c=a[1],r=o.a.useState(!0),i=Object(u.a)(r,2),l=i[0],s=i[1],m=o.a.useState(!1),p=Object(u.a)(m,2),d=p[0],_=p[1],f=o.a.useState(""),b=Object(u.a)(f,2),h=b[0],v=b[1],E=o.a.useState(!0),g=Object(u.a)(E,2),C=g[0],O=g[1],j=o.a.useState(!1),S=Object(u.a)(j,2),k=S[0],N=S[1],y=l&&C;return o.a.createElement(R,{title:"\u0412\u0445\u043e\u0434",buttonTitle:"\u0412\u043e\u0439\u0442\u0438",buttonEnabled:y,linkText:"\u0415\u0449\u0451 \u043d\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",linkTo:"/sign-up"},o.a.createElement(T,{className:"signform__input popup__input_email",wrapClasses:"signform__inputdiv",type:"email",name:"email",placeholder:"Email",value:n,onChange:function(e){_(!0),c(e.target.value)},required:!0,maxLength:"40",isTouched:d,onButtonStatusChange:s}),o.a.createElement(T,{className:"signform__input popup__input_password",wrapClasses:"signform__inputdiv",type:"password",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:h,onChange:function(e){N(!0),v(e.target.value)},required:!0,maxLength:"40",isTouched:k,onButtonStatusChange:O}))},I=function(e){var t=o.a.useState(""),a=Object(u.a)(t,2),n=a[0],c=a[1],r=o.a.useState(!0),i=Object(u.a)(r,2),l=i[0],s=i[1],m=o.a.useState(!1),p=Object(u.a)(m,2),d=p[0],_=p[1],f=o.a.useState(""),b=Object(u.a)(f,2),h=b[0],v=b[1],E=o.a.useState(!0),g=Object(u.a)(E,2),C=g[0],O=g[1],j=o.a.useState(!1),S=Object(u.a)(j,2),k=S[0],N=S[1],y=l&&C;return o.a.createElement(R,{title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",buttonTitle:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",buttonEnabled:y,linkText:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0412\u043e\u0439\u0442\u0438",linkTo:"/sign-in"},o.a.createElement(T,{className:"signform__input popup__input_email",wrapClasses:"signform__inputdiv",type:"email",name:"email",placeholder:"Email",value:n,onChange:function(e){_(!0),c(e.target.value)},required:!0,maxLength:"40",isTouched:d,onButtonStatusChange:s}),o.a.createElement(T,{className:"signform__input popup__input_password",wrapClasses:"signform__inputdiv",type:"password",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:h,onChange:function(e){N(!0),v(e.target.value)},required:!0,maxLength:"40",isTouched:k,onButtonStatusChange:O}))},H=function(){var e=Object(n.useState)(!1),t=Object(u.a)(e,2),a=t[0];t[1],Object(l.g)();return o.a.createElement("div",{className:"page"},o.a.createElement(l.d,null,o.a.createElement(l.b,{path:"/sign-in"},o.a.createElement(f,null,o.a.createElement(i.b,{className:"header__link",to:"/sign-up"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f")),o.a.createElement(A,null)),o.a.createElement(l.b,{path:"/sign-up"},o.a.createElement(f,null,o.a.createElement(i.b,{className:"header__link",to:"/sign-in"},"\u0412\u0445\u043e\u0434")),o.a.createElement(I,null)),o.a.createElement(m,{loggedIn:a,component:D})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(i.a,null,o.a.createElement(H,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[26,1,2]]]);
//# sourceMappingURL=main.69569946.chunk.js.map